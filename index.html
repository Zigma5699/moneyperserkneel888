<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Web + GAS</title>
</head>
<body>

  <h1>ติดต่อกับ Google Apps Script</h1>
  <button onclick="sendData()">ส่งข้อมูล</button>

  <script>

  // script.js
function sendData() {
  fetch("https://script.google.com/macros/s/AKfycbz_WOd860CnsFOLCaG7lHqwNbb3sZus1WyrprUfji7co1bWSsi4FeZ4Jj9QFTbzNvio/exec", {
    method: "POST",
    body: JSON.stringify({ message: "สวัสดีจากเว็บ!" }),
    headers: {
      "Content-Type": "application/json"
    }
  })
  .then(res => res.json())
  .then(data => alert("ตอบกลับ: " + data.reply))
  .catch(err => console.error(err));
}

function doOptions(e) {
  return ContentService.createTextOutput("")
    .setMimeType(ContentService.MimeType.TEXT)
    .setHeader("Access-Control-Allow-Origin", "*")
    .setHeader("Access-Control-Allow-Headers", "Content-Type")
    .setHeader("Access-Control-Allow-Methods", "POST, OPTIONS");
}

</script>
</body>
</html>
